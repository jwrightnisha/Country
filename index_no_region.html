<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Country CSV + SQL Tool (Extended Version)</title>

  <!--
    We use the AlaSQL library so that students can run SQL queries
    directly in the browser, without installing any database software.
    The library is loaded from a public CDN.
  -->
  <script src="https://cdn.jsdelivr.net/npm/alasql@1.7/dist/alasql.min.js"></script>

  <style>
    /* ----- BASIC PAGE STYLING ----- */
    body {
      font-family: Arial, sans-serif;      /* Use a simple, readable font */
      background-color: #ffffe0;           /* Light yellow background, similar to the screenshot */
      margin: 0;
      padding: 10px 20px;
    }

    h2 {
      margin: 0 0 5px 0;                   /* Small space below the heading */
    }

    /* Row that holds the "Import file" controls and status text */
    .top-row {
      display: flex;                       /* Lay items out from left to right */
      align-items: center;                 /* Vertically center the items */
      gap: 10px;                           /* Small space between items */
      margin-bottom: 10px;
      flex-wrap: wrap;                     /* Wrap onto a new line if the screen is narrow */
    }

    .file-label {
      font-weight: bold;
      margin-right: 10px;
    }

    /* Row that holds the data-entry fields for a new country record */
    .fields-row {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      margin: 10px 0;
      flex-wrap: wrap;                     /* Allow the inputs to wrap on small screens */
    }

    /* Each label+input pair is grouped vertically */
    .field-group {
      display: flex;
      flex-direction: column;             /* Stack label below the input */
      align-items: center;
      gap: 3px;
    }

    /* Styling for each text / number input field */
    .field-group input {
      width: 110px;                       /* Fixed width so all boxes look similar */
      padding: 3px 5px;
      border-radius: 3px;
      border: 1px solid #999;
    }

    /* Main green buttons such as "Create New" and "Run SQL" */
    .button-main {
      padding: 10px 20px;
      border-radius: 10px;
      border: 1px solid #688c7a;
      background-color: #c8e6da;
      color: #c00;                        /* Red text to match the screenshot */
      font-weight: bold;
      cursor: pointer;
      font-size: 16px;
    }

    .button-main:hover {
      filter: brightness(0.95);           /* Slightly darken on hover */
    }

    /* Smaller secondary buttons, such as example queries and download CSV */
    .button-secondary {
      padding: 6px 12px;
      border-radius: 6px;
      border: 1px solid #688c7a;
      background-color: #e1f2ea;
      cursor: pointer;
      font-size: 14px;
    }

    .button-secondary:hover {
      filter: brightness(0.97);
    }

    /* Layout for the lower half of the page:
       - left: SQL text area + buttons
       - right: output text area
    */
    .bottom-row {
      display: grid;
      grid-template-columns: 1fr 1.5fr;   /* Left column narrower than right column */
      gap: 20px;
      margin-top: 15px;
      align-items: start;
    }

    /* Multi-line text area where students type SQL commands */
    #sqlInput {
      width: 100%;
      height: 120px;
      padding: 5px;
      box-sizing: border-box;
      border-radius: 4px;
      border: 1px solid #999;
      font-family: Consolas, "Courier New", monospace; /* Code-style font for SQL */
    }

    /* Multi-line text area that shows the results of SQL queries */
    #output {
      width: 100%;
      height: 260px;
      padding: 5px;
      box-sizing: border-box;
      border-radius: 4px;
      border: 1px solid #999;
      font-family: Consolas, "Courier New", monospace;
      white-space: pre;                   /* Preserve spaces and new lines exactly */
    }

    /* Container for the SQL input and its buttons */
    .left-bottom-controls {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .status {
      margin-top: 5px;
      font-size: 12px;
      color: #555;
    }

    /* Row that contains the "example SQL" buttons */
    .examples-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 5px;
    }

    /* Simple row layout for the "Run SQL" and "Clear Output" buttons */
    .sql-buttons-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }
  </style>
</head>
<body>
  <!-- === IMPORT FILE HEADING === -->
  <h2>Import File</h2>

  <!-- === FILE IMPORT CONTROLS === -->
  <div class="top-row">
    <!-- Label for the file input -->
    <span class="file-label">CSV:</span>

    <!--
      File input control.
      The user can choose an existing .csv file from their computer.
      When the file is chosen, JavaScript will read the contents and
      load them into memory and into the AlaSQL table.
    -->
    <input type="file" id="fileInput" accept=".csv" />

    <!--
      Button that lets the user download the current in-memory data
      as a fresh CSV file.
    -->
    <button id="downloadBtn" class="button-secondary" type="button">
      Save Current Data as CSV
    </button>

    <!--
      Button that lets the user download a SAMPLE CSV file
      containing 100 countries (for practice).
      The HTML file you are reading right now does not itself
      contain the data; instead, your teacher may provide
      a separate countries_100.csv file.  However, this button
      demonstrates how such a feature would be wired up.
    -->
    <button id="downloadSampleBtn" class="button-secondary" type="button">
      Download Sample 100-Country CSV
    </button>

    <!-- Status text that shows how many rows are loaded, etc. -->
    <span id="status" class="status">No file loaded.</span>
  </div>

  <!-- === DATA ENTRY FIELDS FOR A NEW ROW === -->
  <div class="fields-row">
    <!--
      Each of these field-group divs holds one input box
      and a label beneath it.  When the user fills in the boxes
      and clicks "Create New", a new row is added to the in‑memory data
      AND to the AlaSQL table.
    -->
    <div class="field-group">
      <input type="number" id="idInput" />
      <span>ID</span>
    </div>
    <div class="field-group">
      <input type="text" id="countryInput" />
      <span>Country</span>
    </div>
    <div class="field-group">
      <input type="text" id="isoInput" />
      <span>ISO</span>
    </div>
    <div class="field-group">
      <input type="number" id="populationInput" />
      <span>Population</span>
    </div>
    <div class="field-group">
      <input type="number" id="gdpInput" step="0.01" />
      <span>GDP (total)</span>
    </div>
    <div class="field-group">
      <input type="number" id="gdpPcInput" step="0.01" />
      <span>GDP / Capita</span>
    </div>
    <div class="field-group">
      <input type="number" id="lifeExpInput" step="0.01" />
      <span>Life Exp.</span>
    </div>
    <div class="field-group">
      <input type="number" id="co2Input" step="0.01" />
      <span>CO₂ Emissions</span>
    </div>

    <!--
      Button that takes whatever is typed into the boxes above
      and creates a brand new row in our data.
    -->
    <button id="createBtn" class="button-main" type="button">
      Create New
    </button>
  </div>

  <!-- === LOWER SECTION: SQL INPUT + OUTPUT === -->
  <div class="bottom-row">
    <!-- LEFT: SQL INPUT + BUTTONS + EXAMPLE QUERIES -->
    <div class="left-bottom-controls">
      <!--
        Multi‑line area where the student types their SQL.
        Example:
        SELECT * FROM countries LIMIT 10;
      -->
      <textarea id="sqlInput" placeholder="Type SQL here, e.g.&#10;SELECT * FROM countries LIMIT 10;"></textarea>

      <!-- Row that holds the Run SQL and Clear Output buttons -->
      <div class="sql-buttons-row">
        <!--
          Clicking this button will read the text from #sqlInput,
          send it to AlaSQL, and display the result in #output.
        -->
        <button id="runSqlBtn" class="button-main" type="button">Run SQL</button>

        <!--
          This button simply clears the output text area so
          that the student can more easily see new results.
        -->
        <button id="clearOutputBtn" class="button-secondary" type="button">
          Clear Output
        </button>
      </div>

      <!-- Example SQL buttons: clicking one fills in the SQL text area -->
      <div class="examples-row">
        <button class="button-secondary" type="button"
          onclick="setExample('SELECT * FROM countries LIMIT 10;')">
          Example 1: First 10 rows
        </button>

        <button class="button-secondary" type="button"
          onclick="setExample('SELECT Country, Population FROM countries ORDER BY Population DESC LIMIT 10;')">
          Top 10 by Population
        </button>

        <button class="button-secondary" type="button"
          onclick="setExample('SELECT AVG(GDP_per_capita) AS avg_gdp_pc FROM countries;')">
          Average GDP / Capita (All Countries)
        </button>

        <button class="button-secondary" type="button"
          onclick="setExample('SELECT Country, Life_expectancy FROM countries WHERE Life_expectancy &gt; 80 ORDER BY Life_expectancy DESC;')">
          Life Expectancy &gt; 80
        </button>

        <button class="button-secondary" type="button"
          onclick="setExample('SELECT Country, CO2_emissions FROM countries ORDER BY CO2_emissions DESC LIMIT 10;')">
          Highest CO₂ Emitters
        </button>

        <button class="button-secondary" type="button"
          onclick="setExample('SELECT COUNT(*) AS num_countries FROM countries;')">
          Total Number of Countries
        </button>
      </div>
    </div>

    <!-- RIGHT: OUTPUT AREA -->
    <textarea id="output" readonly placeholder="SQL output will appear here..."></textarea>
  </div>

  <script>
    /* ============================================================
       SECTION 1: BASIC GLOBAL VARIABLES AND CONSTANTS
       ============================================================ */

    // dataRows will always hold the current table as a JavaScript array.
    // Each element in the array is one object (one country row).
    // Example object:
    // {
    //   ID: 1,
    //   Country: "Canada",
    //   ISO: "CAN",
    //   Region: "Americas",
    //   Population: 38000000,
    //   GDP: 1800000000000,
    //   GDP_per_capita: 47000,
    //   Life_expectancy: 82.3,
    //   CO2_emissions: 15.0
    // }
    let dataRows = [];

    // These are the column names we expect and use when saving CSV files.
    // The order of these headers is important, because we use it when
    // generating a CSV download.
    const headers = [
      "ID",
      "Country",
      "ISO",
      "Population",
      "GDP",
      "GDP_per_capita",
      "Life_expectancy",
      "CO2_emissions"
    ];

    // References to some frequently-used DOM elements:
    const statusSpan = document.getElementById("status");
    const outputArea = document.getElementById("output");
    const sqlInputArea = document.getElementById("sqlInput");

    /* ============================================================
       SECTION 2: HELPER FUNCTION TO SET EXAMPLE SQL
       ============================================================ */

    /**
     * setExample(sqlText)
     * -------------------
     * This function simply replaces the text inside the SQL input area
     * with a preset SQL statement when the user clicks one of the
     * "Example" buttons.
     *
     * @param {string} sqlText - The SQL query to place into the text area.
     */
    function setExample(sqlText) {
      sqlInputArea.value = sqlText;
    }

    /* ============================================================
       SECTION 3: INITIALIZING AND RELOADING THE AlaSQL TABLE
       ============================================================ */

    /**
     * initEmptyTable()
     * ----------------
     * Removes any existing "countries" table from AlaSQL (if it exists)
     * and creates a new, empty table with the desired columns.
     *
     * This function is used:
     *   - when the page first loads (so students can run SQL right away)
     *   - whenever we load dataRows from a CSV file
     */
    function initEmptyTable() {
      // Drop the table if it already exists, ignoring errors.
      alasql("DROP TABLE IF EXISTS countries");

      // Create a fresh table with columns that match our headers array.
      alasql(
        "CREATE TABLE countries (" +
          "ID INT, " +
          "Country STRING, " +
          "ISO STRING, " +
          "Population INT, " +
          "GDP FLOAT, " +
          "GDP_per_capita FLOAT, " +
          "Life_expectancy FLOAT, " +
          "CO2_emissions FLOAT" +
        ")"
      );
    }

    /**
     * loadIntoDatabase()
     * ------------------
     * Clears and re-creates the AlaSQL "countries" table,
     * then inserts one row for each object currently stored
     * in the dataRows array.
     */
    function loadIntoDatabase() {
      // Always rebuild the table from scratch.
      initEmptyTable();

      // Insert each row from the JavaScript array into the AlaSQL table.
      dataRows.forEach((row) => {
        // Insert each JavaScript object as a row in the AlaSQL table.
        alasql("INSERT INTO countries VALUES (?,?,?,?,?,?,?,?)", [
          row.ID,
          row.Country,
          row.ISO,
          row.Population,
          row.GDP,
          row.GDP_per_capita,
          row.Life_expectancy,
          row.CO2_emissions
        ]);
      });

      // Update the status message so the user can see how many rows are loaded.
      statusSpan.textContent =
        "Loaded " + dataRows.length + " row(s) into table 'countries'.";
    }

    /* ============================================================
       SECTION 4: CSV PARSING (READING FILES)
       ============================================================ */

    /**
     * parseCSV(text)
     * --------------
     * Reads a CSV string and fills the dataRows array.
     *
     * This function is deliberately kept simple so that students can
     * understand how it works.  It assumes:
     *   - One row per line.
     *   - Columns are separated by commas.
     *   - No commas appear inside the actual values.
     *
     * IMPORTANT: This function supports both:
     *   (a) the **old format** with 6 columns:
     *       ID, Country, ISO, Region, Population, GDP
     *   (b) the **new format** with up to 9 columns:
     *       ID, Country, ISO, Region, Population, GDP,
     *       GDP_per_capita, Life_expectancy, CO2_emissions
     *
     * For 6‑column data:
     *   - GDP_per_capita is automatically computed as GDP / Population
     *     (if Population is greater than 0).
     *   - Life_expectancy and CO2_emissions are set to 0 by default.
     */
    function parseCSV(text) {
      /*
        parseCSV(text)
        --------------
        This function takes the *raw text* from a CSV file and converts it
        into an array of JavaScript objects stored in dataRows.

        Each line in the CSV becomes ONE object (one country).  For example,
        a line like this:

          1,Canada,CAN,38000000,1800000000000,47368,82.3,15.0

        is interpreted as:

          {
            ID: 1,
            Country: "Canada",
            ISO: "CAN",
            Population: 38000000,
            GDP: 1800000000000,
            GDP_per_capita: 47368,
            Life_expectancy: 82.3,
            CO2_emissions: 15.0
          }

        Expected column order in the CSV:
          ID, Country, ISO, Population, GDP, GDP_per_capita, Life_expectancy, CO2_emissions

        The function is also a bit flexible:
          - If a line only has 5 columns
              (ID, Country, ISO, Population, GDP),
            we will automatically COMPUTE GDP_per_capita as GDP / Population
            and set Life_expectancy and CO2_emissions to 0.
      */

      // 1) Split the entire text into individual lines.
      //    The regular expression handles both Windows (\r\n) and Unix (\n) endings.
      const lines = text.trim().split(/\r?\n/);

      // If the file somehow had no actual data (just a header or empty),
      // we clear dataRows and rebuild an empty table.
      if (lines.length <= 1) {
        dataRows = [];
        loadIntoDatabase();
        return;
      }

      // We assume the FIRST line is a header row naming the columns.
      // We ignore its actual words, because we already know our own headers.
      dataRows = [];

      // 2) Loop over each remaining line (these are the data rows).
      for (let i = 1; i < lines.length; i++) {
        const line = lines[i].trim();

        // Skip if the line is completely empty (for example, a blank line at the end).
        if (!line) continue;

        // Split this line into its comma‑separated pieces.
        const cells = line.split(",");

        let row;

        if (cells.length === 5) {
          // ------------------------------------------------------
          // CASE A: 5 columns: ID, Country, ISO, Population, GDP
          // ------------------------------------------------------
          const id = parseInt(cells[0], 10) || 0;
          const country = cells[1] || "";
          const iso = cells[2] || "";
          const population = parseInt(cells[3], 10) || 0;
          const gdp = parseFloat(cells[4]) || 0;

          // Avoid dividing by 0.  If Population is 0, we just use 0.
          const gdpPerCapita =
            population > 0 ? gdp / population : 0;

          row = {
            ID: id,
            Country: country,
            ISO: iso,
            Population: population,
            GDP: gdp,
            GDP_per_capita: gdpPerCapita,
            Life_expectancy: 0,
            CO2_emissions: 0
          };
        } else {
          // ------------------------------------------------------
          // CASE B: 8 or more columns matching our full header set:
          //   ID, Country, ISO,
          //   Population, GDP, GDP_per_capita,
          //   Life_expectancy, CO2_emissions
          // Any extra columns at the end are ignored.
          // ------------------------------------------------------

          // Make sure we have at least 8 cells so we can safely index them.
          while (cells.length < headers.length) {
            cells.push("");
          }

          const id = parseInt(cells[0], 10) || 0;
          const country = cells[1] || "";
          const iso = cells[2] || "";
          const population = parseInt(cells[3], 10) || 0;
          const gdp = parseFloat(cells[4]) || 0;

          // If GDP_per_capita is missing or invalid, we compute it.
          let gdpPerCapita = parseFloat(cells[5]);
          if (!gdpPerCapita && population > 0) {
            gdpPerCapita = gdp / population;
          }
          if (!gdpPerCapita) gdpPerCapita = 0;

          const lifeExp = parseFloat(cells[6]) || 0;
          const co2 = parseFloat(cells[7]) || 0;

          row = {
            ID: id,
            Country: country,
            ISO: iso,
            Population: population,
            GDP: gdp,
            GDP_per_capita: gdpPerCapita,
            Life_expectancy: lifeExp,
            CO2_emissions: co2
          };
        }

        // Add this newly‑created row object to our main data array.
        dataRows.push(row);
      }

      // Finally, push all of these rows into the AlaSQL in‑memory table.
      loadIntoDatabase();
    }
    }

    /* ============================================================
       SECTION 5: FILE INPUT HANDLING
       ============================================================ */

    // When the user chooses a CSV file, read it and parse it.
    document.getElementById("fileInput").addEventListener("change", (e) => {
      const file = e.target.files[0];

      // If no file was actually selected (user cancelled the dialog),
      // simply return.
      if (!file) return;

      // Use the FileReader API to read the text contents of the file.
      const reader = new FileReader();

      // When the file has finished loading, parse its text as CSV.
      reader.onload = (evt) => {
        parseCSV(evt.target.result);
        // Clear any previous SQL output so students see a fresh start.
        outputArea.value = "";
      };

      // Actually read the file as text (UTF‑8).
      reader.readAsText(file);
    });

    /* ============================================================
       SECTION 6: CREATING A NEW ROW FROM INPUT BOXES
       ============================================================ */

    // Handle clicks on the "Create New" button.
    document.getElementById("createBtn").addEventListener("click", () => {
      /*
        When the user clicks "Create New", we look at all the input boxes
        above, build ONE JavaScript object representing a country, and then:

          1. Add it to our dataRows array (our own copy of the table)
          2. INSERT it into the AlaSQL in‑memory table called "countries"

        This means that the new row will also appear in any future SQL queries.
      */
      const row = {
        ID: parseInt(document.getElementById("idInput").value, 10) || 0,
        Country: document.getElementById("countryInput").value.trim(),
        ISO: document.getElementById("isoInput").value.trim(),
        Population:
          parseInt(document.getElementById("populationInput").value, 10) || 0,
        GDP: parseFloat(document.getElementById("gdpInput").value) || 0,
        GDP_per_capita:
          parseFloat(document.getElementById("gdpPcInput").value) || 0,
        Life_expectancy:
          parseFloat(document.getElementById("lifeExpInput").value) || 0,
        CO2_emissions:
          parseFloat(document.getElementById("co2Input").value) || 0
      };

      // 1) Add the new row to our in‑memory JavaScript array.
      dataRows.push(row);

      // 2) Also insert the new row into the AlaSQL table
      //    so that future SQL queries can "see" it.
      alasql("INSERT INTO countries VALUES (?,?,?,?,?,?,?,?)", [
        row.ID,
        row.Country,
        row.ISO,
        row.Population,
        row.GDP,
        row.GDP_per_capita,
        row.Life_expectancy,
        row.CO2_emissions
      ]);

      // Let the user know that it worked and show the new total row count.
      statusSpan.textContent =
        "Row added. Total rows in 'countries': " + dataRows.length;

      // Finally, clear all the text boxes to make data entry faster.
      document.getElementById("idInput").value = "";
      document.getElementById("countryInput").value = "";
      document.getElementById("isoInput").value = "";
      document.getElementById("populationInput").value = "";
      document.getElementById("gdpInput").value = "";
      document.getElementById("gdpPcInput").value = "";
      document.getElementById("lifeExpInput").value = "";
      document.getElementById("co2Input").value = "";
    });

    /* ============================================================
       SECTION 7: RUNNING SQL AND CLEARING THE OUTPUT
       ============================================================ */

    // When the user clicks "Run SQL", send the SQL text to AlaSQL.
    document.getElementById("runSqlBtn").addEventListener("click", () => {
      /*
        When the user clicks "Run SQL":

          1. We read the text they typed into the SQL box.
          2. We send that text to the AlaSQL library.
          3. AlaSQL runs the query *in memory* on our "countries" table.
          4. We format the result and show it in the Output box on the right.
      */
      const sql = sqlInputArea.value.trim();

      // If the box is empty, we remind the user to type something.
      if (!sql) {
        outputArea.value = "Please type a SQL statement.";
        return;
      }

      try {
        // Ask AlaSQL to execute the query string.
        const result = alasql(sql);

        // SELECT queries usually return an ARRAY of row objects.
        if (Array.isArray(result)) {
          if (result.length === 0) {
            outputArea.value = "(No rows returned.)";
            return;
          }

          // Get the list of column names from the *first* row.
          // We assume all rows have the same set of columns.
          const cols = Object.keys(result[0]);

          // We will build the output as an ARRAY of lines,
          // then join it into one big string at the end.
          const lines = [];

          // First line: a tab‑separated header row.
          lines.push(cols.join("\t"));

          // Each following line is one row of results, also tab‑separated.
          result.forEach((row) => {
            lines.push(
              cols
                .map((c) => {
                  const val = row[c];
                  if (val === undefined || val === null) return "";

                  // For large numeric columns, use nicer formatting so
                  // the output is easier for humans to read.
                  if (["Population", "GDP"].includes(c)) {
                    return Number(val).toLocaleString("en-US");
                  }

                  // GDP_per_capita is formatted with up to 2 decimals.
                  if (c === "GDP_per_capita") {
                    return Number(val).toLocaleString("en-US", {
                      minimumFractionDigits: 0,
                      maximumFractionDigits: 2
                    });
                  }

                  // For all other columns, just convert to a string.
                  return String(val);
                })
                .join("\t")
            );
          });

          // Finally, join all lines with newlines to create one big block of text.
          outputArea.value = lines.join("\n");
        } else {
          // Non‑SELECT queries (INSERT, UPDATE, DELETE, etc.) often return
          // a number such as "how many rows were affected".
          outputArea.value = String(result);
        }
      } catch (err) {
        // If something goes wrong (for example, a syntax error in SQL),
        // we catch the exception and show the message instead of crashing.
        outputArea.value = "Error: " + err.message;
      }
    });

    // Clear the output text area when "Clear Output" is clicked.
    document.getElementById("clearOutputBtn").addEventListener("click", () => {
      outputArea.value = "";
    });

    /* ============================================================
       SECTION 8: DOWNLOADING CURRENT DATA AS A CSV FILE
       ============================================================ */

    document.getElementById("downloadBtn").addEventListener("click", () => {
      // If there are no rows, warn the user and do nothing.
      if (!dataRows.length) {
        alert("No data to save.");
        return;
      }

      // Build an array of CSV lines (strings).
      const lines = [];

      // First line is the header row.
      lines.push(headers.join(","));

      // Add one line per row of data.
      dataRows.forEach((row) => {
        // Turn each JavaScript object into one CSV line.
        lines.push(
          [
            row.ID,
            row.Country,
            row.ISO,
            row.Population,
            row.GDP,
            row.GDP_per_capita,
            row.Life_expectancy,
            row.CO2_emissions
          ].join(",")
        );
      });

      // Combine all lines into one big string with newlines between them.
      const csvText = lines.join("\n");

      // Create a Blob (binary large object) from our CSV string.
      const blob = new Blob([csvText], {
        type: "text/csv;charset=utf-8;"
      });

      // Create a temporary object URL that points to the Blob.
      const url = URL.createObjectURL(blob);

      // Programmatically create an invisible <a> element and click it
      // so that the browser downloads the file.
      const link = document.createElement("a");
      link.href = url;
      link.download = "countries.csv";  // Suggested name for the file
      document.body.appendChild(link);
      link.click();

      // Clean up the temporary link and URL.
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    });

    /* ============================================================
       SECTION 9: DOWNLOADING A SAMPLE 100-COUNTRY CSV
       ============================================================ */

    // Sample CSV text for 100 countries.
    // NOTE: The numeric values here are synthetic (made up) but
    //       are internally consistent and realistic in scale.
    //       For official statistics, replace this with a real dataset.
    const sampleCsvText =
`ID,Country,ISO,Population,GDP,GDP_per_capita,Life_expectancy,CO2_emissions
1,Canada,CAN,38000000,1800000000000,47368,82.3,15.0
2,United States,USA,331000000,23000000000000,69577,78.8,14.7
3,Mexico,MEX,128000000,1300000000000,10156,75.0,3.9
4,Brazil,BRA,213000000,1600000000000,7512,75.5,2.3
5,Argentina,ARG,45000000,450000000000,10000,76.7,4.5
6,Chile,CHL,19000000,317000000000,16684,80.0,4.4
7,Colombia,COL,51000000,320000000000,6274,77.2,2.0
8,Peru,PER,33000000,225000000000,6818,76.5,1.9
9,Venezuela,VEN,28000000,70000000000,2500,72.1,5.0
10,Cuba,CUB,11300000,100000000000,8849,79.2,2.6
11,Dominican Republic,DOM,11000000,94000000000,8545,74.5,2.3
12,Guatemala,GTM,18000000,85000000000,4722,74.3,1.6
13,Honduras,HND,10000000,28000000000,2800,73.8,1.1
14,Costa Rica,CRI,5100000,64000000000,12549,80.4,1.6
15,Panama,PAN,4400000,70000000000,15909,78.5,2.5
16,Jamaica,JAM,3000000,17000000000,5667,74.1,2.0
17,El Salvador,SLV,6500000,31000000000,4769,73.1,1.4
18,Nicaragua,NIC,6600000,14000000000,2121,74.7,0.9
19,Haiti,HTI,11400000,14000000000,1228,64.0,0.3
20,Bolivia,BOL,12000000,40000000000,3333,71.5,1.7
21,United Kingdom,GBR,67000000,3100000000000,46269,81.2,5.5
22,France,FRA,65000000,2900000000000,44615,82.5,4.8
23,Germany,DEU,83000000,4200000000000,50602,81.0,8.4
24,Italy,ITA,60000000,2100000000000,35000,83.4,5.9
25,Spain,ESP,47000000,1500000000000,31915,83.1,5.1
26,Portugal,PRT,10000000,250000000000,25000,81.9,4.0
27,Netherlands,NLD,17500000,1000000000000,57143,82.0,9.5
28,Belgium,BEL,11500000,550000000000,47826,81.7,8.0
29,Sweden,SWE,10400000,600000000000,57692,82.8,3.5
30,Norway,NOR,5400000,480000000000,88889,82.9,8.3
31,Denmark,DNK,5900000,400000000000,67797,81.4,5.6
32,Finland,FIN,5500000,300000000000,54545,82.3,7.7
33,Ireland,IRL,5000000,500000000000,100000,82.6,7.8
34,Switzerland,CHE,8700000,800000000000,91954,83.6,4.4
35,Austria,AUT,9000000,480000000000,53333,81.8,6.8
36,Poland,POL,38000000,700000000000,18421,78.0,8.2
37,Czechia,CZE,10700000,280000000000,26168,79.2,9.0
38,Hungary,HUN,9600000,180000000000,18750,76.8,5.2
39,Greece,GRC,10700000,220000000000,20561,81.0,6.4
40,Romania,ROU,19000000,300000000000,15789,75.6,3.6
41,Russia,RUS,145000000,1700000000000,11724,72.4,11.5
42,Ukraine,UKR,41000000,150000000000,3659,72.0,5.0
43,Turkey,TUR,84000000,800000000000,9524,77.7,4.4
44,China,CHN,1410000000,17000000000000,12057,77.3,7.4
45,India,IND,1380000000,3400000000000,2464,69.7,1.9
46,Japan,JPN,125000000,5000000000000,40000,84.5,8.9
47,South Korea,KOR,52000000,1800000000000,34615,83.3,11.7
48,Indonesia,IDN,273000000,1200000000000,4396,71.7,2.3
49,Pakistan,PAK,225000000,350000000000,1556,67.3,0.9
50,Bangladesh,BGD,165000000,410000000000,2485,72.6,0.7
51,Sri Lanka,LKA,22000000,90000000000,4091,77.0,1.0
52,Nepal,NPL,30000000,36000000000,1200,70.8,0.5
53,Thailand,THA,70000000,540000000000,7714,77.2,4.5
54,Vietnam,VNM,98000000,410000000000,4184,75.4,2.0
55,Malaysia,MYS,33000000,370000000000,11212,76.2,8.0
56,Singapore,SGP,5700000,400000000000,70175,83.5,7.9
57,Philippines,PHL,109000000,390000000000,3578,71.0,1.6
58,Myanmar,MMR,54000000,70000000000,1296,66.9,0.7
59,Cambodia,KHM,17000000,28000000000,1647,69.8,0.7
60,Laos,LAO,7300000,19000000000,2603,68.7,0.5
61,Saudi Arabia,SAU,35000000,800000000000,22857,75.0,18.5
62,United Arab Emirates,ARE,9900000,420000000000,42424,79.0,22.0
63,Qatar,QAT,2800000,180000000000,64286,80.2,35.0
64,Kuwait,KWT,4300000,120000000000,27907,76.9,25.0
65,Iran,IRN,84000000,230000000000,2738,76.0,8.0
66,Iraq,IRQ,41000000,190000000000,4634,70.6,4.7
67,Israel,ISR,9300000,520000000000,55914,83.0,7.8
68,Jordan,JOR,10000000,45000000000,4500,74.3,3.1
69,Lebanon,LBN,6800000,20000000000,2941,78.9,3.7
70,Australia,AUS,26000000,1600000000000,61538,83.0,15.4
71,New Zealand,NZL,5100000,250000000000,49020,82.3,7.0
72,Papua New Guinea,PNG,9000000,25000000000,2778,65.2,0.9
73,Fiji,FJI,900000,5000000000,5556,67.3,1.9
74,Solomon Islands,SLB,700000,1600000000,2286,73.0,0.4
75,Samoa,WSM,200000,900000000,4500,73.8,0.6
76,Tonga,TON,100000,500000000,5000,70.9,0.6
77,Nigeria,NGA,206000000,450000000000,2184,54.3,0.7
78,Ethiopia,ETH,115000000,110000000000,956,66.6,0.2
79,Egypt,EGY,102000000,400000000000,3922,72.0,2.5
80,South Africa,ZAF,60000000,370000000000,6167,64.1,7.5
81,Kenya,KEN,54000000,110000000000,2037,66.7,0.4
82,Tanzania,TZA,59000000,67000000000,1136,65.5,0.3
83,Uganda,UGA,45000000,45000000000,1000,63.4,0.2
84,Ghana,GHA,31000000,70000000000,2258,64.5,0.6
85,Ivory Coast,CIV,26000000,70000000000,2692,58.0,0.7
86,Senegal,SEN,17000000,27000000000,1588,67.0,0.7
87,Algeria,DZA,44000000,170000000000,3864,76.1,3.9
88,Morocco,MAR,37000000,130000000000,3514,76.9,2.0
89,Tunisia,TUN,12000000,40000000000,3333,76.5,2.5
90,Angola,AGO,33000000,62000000000,1879,61.6,1.3
91,Mozambique,MOZ,31000000,16000000000,516,61.0,0.3
92,Madagascar,MDG,28000000,14000000000,500,67.0,0.2
93,Zimbabwe,ZWE,15000000,21000000000,1400,62.5,0.8
94,Zambia,ZMB,19000000,23000000000,1211,63.0,0.4
95,Cameroon,CMR,27000000,39000000000,1444,60.3,0.4
96,Democratic Republic of the Congo,COD,90000000,55000000000,611,60.0,0.1
97,Sudan,SDN,44000000,30000000000,682,65.1,0.4
98,Chad,TCD,17000000,12000000000,706,54.0,0.1
99,Niger,NER,24000000,14000000000,583,62.0,0.1
100,Mali,MLI,20000000,17000000000,850,59.3,0.2`;

    // When "Download Sample 100-Country CSV" is clicked, create a Blob
    // from the sampleCsvText and trigger a download.
    document.getElementById("downloadSampleBtn").addEventListener("click", () => {
      const blob = new Blob([sampleCsvText], {
        type: "text/csv;charset=utf-8;"
      });

      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      link.href = url;
      link.download = "countries_100_sample.csv";
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    });

    /* ============================================================
       SECTION 10: INITIALIZATION ON PAGE LOAD
       ============================================================ */

    // When the page first loads, we immediately create an empty
    // AlaSQL table so that students can experiment with SQL even
    // before they load any real data.
    initEmptyTable();
  </script>
</body>
</html>
